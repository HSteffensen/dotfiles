# Some stuff before p10k instant prompt, because it can print to console
if [[ -s "$HOME/.sdkman/bin/sdkman-init.sh" ]]; then
  export SDKMAN_DIR="$HOME/.sdkman"
  source "$HOME/.sdkman/bin/sdkman-init.sh"
fi

# Download dependencies, if not there yet. Downloads happen before p10k instant prompt.
# znap from https://github.com/marlonrichert/zsh-snap
[[ -r ~/Git/zsh-snap/znap.zsh ]] || git clone --depth 1 -- https://github.com/marlonrichert/zsh-snap.git ~/Git/zsh-snap

# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8
export ZSH_AUTOSUGGEST_STRATEGY=(history completion)
# https://geoff.greer.fm/lscolors/ LSCOLORS tool
# these colors were the system defaults when I got my work mac
export LSCOLORS="Gxfxcxdxbxegedabagacad"
export LS_COLORS="di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43"

zstyle ':completion:*:*:make:*' tag-order 'targets'

source ~/Git/zsh-snap/znap.zsh # Start Znap

znap source romkatv/powerlevel10k
znap source zdharma-continuum/fast-syntax-highlighting
znap source zsh-users/zsh-autosuggestions
znap source zsh-users/zsh-completions
znap source zsh-users/zsh-history-substring-search
# gcloud plugin won't be harmful if gcloud isn't present
znap source ohmyzsh/ohmyzsh plugins/gcloud
znap source lukechilds/zsh-nvm

# from zsh-users/zsh-history-substring-search
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

if (( $+commands[kubectl] )); then
  alias k="kubectl"
  alias kcx="kubectx"
  alias kns="kubens"
  znap fpath _kubectl 'kubectl completion zsh'
fi

if (( $+commands[rustup] )); then
  znap fpath _rustup 'rustup completions zsh'
  znap fpath _cargo 'rustup completions zsh cargo'
fi

alias ls='ls --color=auto --group-directories-first'
alias ll='ls -laF'

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

path+=("$HOME/bin")
export PATH
